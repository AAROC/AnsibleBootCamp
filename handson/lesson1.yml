---
# the first playbook for lesson 1 - a list of tasks with no role

- hosts: all
  accelerate: true
  name: Check the basic connectivity
  tasks:
  - ping:

- hosts: all
  accelerate: true
  name: Set up the basic users
  sudo: true
  tasks:
  - user:
      name: bob
      home: /dev/null

- hosts: all
  accelerate: true
  name: ensure system is properly configured
  sudo: true
  vars_files: lesson1_vars.yml
  tasks:
    - name: ensure that packages are installed
      yum:
        name: "{{ item }}"
        state: present
        with_items: packages
    - name: push the template for ntp.conf
      template:
        src: ntp.conf.j2
        dest: /etc/ntp.conf
    - name: ensure that ntp is started
      service:
        name: ntpd
        state: started

- hosts: all
  accelerate: true
  name: test installation is correct
  tasks:
    - name: Test time drift
      command: /usr/sbin/ntptime
      register: thetime
      changed_when: false
